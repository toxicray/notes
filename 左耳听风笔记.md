#    							左耳听风笔记





















## 性能设计

### 一、性能-缓存

#### Cache-Aside模式

- 失效   应用程序先从cache读取数据,没有得到的话获取db的数据,成功之后放回到缓存
- 命中 直接获取缓存中的数据(可以对数据进行打标,数据来源于缓存还是db)
- 更新 先更新数据,然后再让缓存进行失效



#### READ/WRITE Through模式

在查询和写的操作里面去更新数据, 对于调用方来说透明的,类似于mysql的查询过程

只需要每次标记数据的状态即可,后续根据状态去进行数据的处理



#### WRITE Behind Caching更新模式

Linux文件系统的page cache算法(lazy write)

本质就是在更新数据的时候只需要更新内存的数据,然后直接返回, 这样子的问题就来了, 如果是非正常的关机情况下,可能会有少量的数据丢失情况



mysql有这么个机制,但是为啥不会有数据丢失的问题呢   mysql其实是有WAL机制, 每次都有写日志文件在系统中



### 二、性能-异步

##### 异步的好处就是能让我们把数据的操作进行统一调度

mysql里面其实就有类似的设计,数据写入到日志和内存之后就可以返回了,   闲置的时候刷脏页数据



##### 异步处理的两种模式

**出于解耦的考虑,会有两种模型**

###### push模型

将任务进行派发处理, 上游需要知道下游各个节点的状态,多了任务调度状态

###### pull模型

不需要关心其他节点的状态,减少了系统的复杂度, 少了任务调度



##### 事件溯源设计模式

EventSourcing    对于银行的流水来说,   我们只需要记录每一步的操作就可以得到最后的值

类似于redis的aof的方式





